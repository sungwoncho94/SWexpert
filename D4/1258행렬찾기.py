T = int(input())
for t in range(1, T+1):
    N = int(input())

    range_idx_list = []
    range_list = []
    idx_list = []
    cnt = 0
    fin = False
    result_list = []
    result = []
    temp = []

    matrix = []
    # matrix작성 // N, N구하기
    for n in range(N):
        n_list = list(map(int, input().split()))
        n_list.append(0)
        matrix.append(n_list)
    matrix.append([0 * N])

    # fin == False이면 계속 돌리고, fin == True가 되면 멈추기
    while fin == False:
        flag = 1
        cnt += 1  # 시약통 개수
        start_i = start_j = end_i = end_j = 0  # 변수 초기화
        sum_matrix = 0

        # 행 = N  /  열 = N = len(n_list)
        # start_i, start_j 구하기
        for i in range(N):
            if flag == 0:
                break
            for j in range(N):
                if matrix[i][j] != 0:
                    start_i = i
                    start_j = j
                    flag = 0
                    break

        # end_i, end_j 구하기
        end_i = start_i
        end_j = start_j
        while matrix[end_i+1][end_j] != 0:
            end_i += 1
            if end_i > N -1:
                end_i = N -1
                break
        while matrix[end_i][end_j+1] != 0:
            end_j += 1
            if end_j > N -1:
                end_j = N -1
                break
        
        
        # 넓이와 행렬크기 구하기
        range_idx_list.append((end_i-start_i+1) * (end_j-start_j+1))
        range_idx_list.append([end_i-start_i+1, end_j-start_j+1])
        range_list.append((end_i-start_i+1) * (end_j-start_j+1))
        # idx_list.append([end_i-start_i+1, end_j-start_j+1])

        # 카운트한 시약통은 없애기
        for i in range(start_i, end_i+1):
            for j in range(start_j, end_j+1):
                matrix[i][j] = 0

        # 전체 행렬의 합이 0이 될때까지 반복
        for i in range(N):
            for j in range(N):
                sum_matrix += matrix[i][j]

        if sum_matrix == 0:
            fin = True
        else:
            fin = False

    # while문 끝난 후, idx_list랑 range_list 정리

    while sum(range_list) > 0:
        # temp에 값이 있다면 temp를 result_list 에 넣어주고 다시시작
        if len(temp) > 0:
            temp_min = 99
            while len(temp) > 0:
                for i in range(len(temp)):
                    if temp[i][0] <= temp_min:
                        temp_min = temp[i][0]
                        min_i = i
                result_list.append(temp[i])
                temp.remove(temp[i])
        if range_idx_list.count(min(range_list)) == 1:
            idx = range_idx_list.index(min(range_list))
            result_list.append(range_idx_list[idx+1])
            range_list.remove(min(range_list))
        # 사각형의 크기가 똑같다면
        elif range_idx_list.count(min(range_list)) >= 2:
            # 두개 다 temp에 넣어놓고 정리
            for r in range(range_idx_list.count(min(range_list))):
                idx = range_idx_list.index(min(range_list))
                temp.append(range_idx_list[idx+1])
                range_list.remove(min(range_list))
                range_idx_list[idx] += 100

    result.append(t)
    result.append(cnt)
    for r in result_list:
        result.append(r[0])
        result.append(r[1])

    print('#{}'.format(" ".join(map(str, result))))

'''
60
1 2 3 4 5 6 7 8 9 1 2 3 4 0 0 0 0 0 0 0 0 5 6 7 8 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 9 1 2 3 4 5 6 7 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 8 9 1 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3 4 5 6 7 8 9 1 0 0 0 0 0 0 0 0 0 
2 3 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 5 6 7 8 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 9 1 2 3 4 5 6 7 0 0 0 0 0 0 0 0 0 
8 9 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 3 4 5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 6 7 8 9 1 2 3 4 0 0 0 0 0 0 0 0 0 
5 6 7 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 8 9 1 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3 4 5 6 7 8 9 1 0 0 0 0 0 0 0 0 0 
2 3 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 5 6 7 8 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 9 1 2 3 4 5 6 7 0 0 0 0 0 0 0 0 0 
8 9 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 3 4 5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 6 7 8 9 1 2 3 4 0 0 0 0 0 0 0 0 0 
5 6 7 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 8 9 1 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3 4 5 6 7 8 9 1 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 3 4 5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 6 7 8 9 1 2 3 4 0 0 0 0 0 0 0 0 0 
5 6 7 8 9 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 3 4 5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 6 7 8 9 1 2 3 4 0 0 0 0 0 0 0 0 0 
5 6 7 8 9 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 3 4 5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 6 7 8 9 1 2 3 4 0 0 0 0 0 0 0 0 0 
5 6 7 8 9 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 3 4 5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 6 7 8 9 1 2 3 4 0 0 0 0 0 0 0 0 0 
5 6 7 8 9 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 3 4 5 6 7 8 9 0 0 0 0 0 0 0 0 0 
1 2 3 4 5 6 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 7 8 9 1 2 3 4 5 0 0 0 0 0 0 0 0 0 
6 7 8 9 1 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3 4 5 6 7 8 9 1 2 3 4 5 6 7 8 9 1 2 3 4 0 0 5 6 7 8 9 1 2 3 0 0 0 0 0 0 0 0 0 
4 5 6 7 8 9 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 2 3 4 5 6 7 8 9 1 2 3 4 5 6 7 8 9 1 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
3 4 5 6 7 8 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 9 1 2 3 4 5 6 7 8 9 1 2 3 4 5 6 7 8 9 1 0 0 2 3 4 5 6 7 8 9 1 2 3 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 4 5 6 7 8 9 1 2 3 4 5 6 7 8 9 1 2 3 4 5 0 0 6 7 8 9 1 2 3 4 5 6 7 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 8 9 1 2 3 4 5 6 7 8 9 1 2 3 4 5 6 7 8 9 0 0 1 2 3 4 5 6 7 8 9 1 2 0 0 0 0 0 0 
3 4 5 6 7 8 9 1 2 3 4 5 6 7 8 9 1 2 3 0 0 4 5 6 7 8 9 1 2 3 4 5 6 7 8 9 1 2 3 4 5 0 0 6 7 8 9 1 2 3 4 5 6 7 0 0 0 0 0 0 
8 9 1 2 3 4 5 6 7 8 9 1 2 3 4 5 6 7 8 0 0 9 1 2 3 4 5 6 7 8 9 1 2 3 4 5 6 7 8 9 1 0 0 2 3 4 5 6 7 8 9 1 2 3 0 0 0 0 0 0 
4 5 6 7 8 9 1 2 3 4 5 6 7 8 9 1 2 3 4 0 0 5 6 7 8 9 1 2 3 4 5 6 7 8 9 1 2 3 4 5 6 0 0 7 8 9 1 2 3 4 5 6 7 8 0 0 0 0 0 0 
9 1 2 3 4 5 6 7 8 9 1 2 3 4 5 6 7 8 9 0 0 1 2 3 4 5 6 7 8 9 1 2 3 4 5 6 7 8 9 1 2 0 0 3 4 5 6 7 8 9 1 2 3 4 0 0 0 0 0 0 
5 6 7 8 9 1 2 3 4 5 6 7 8 9 1 2 3 4 5 0 0 6 7 8 9 1 2 3 4 5 6 7 8 9 1 2 3 4 5 6 7 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
8 9 1 2 3 4 5 6 7 8 9 1 2 3 4 5 6 7 8 0 0 9 1 2 3 4 5 6 7 8 9 1 2 3 4 5 6 7 8 9 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
2 3 4 5 6 7 8 9 1 2 3 4 5 6 7 8 9 1 2 0 0 3 4 5 6 7 8 9 1 2 3 4 5 6 7 8 9 1 2 3 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
5 6 7 8 9 1 2 3 4 5 6 7 8 9 1 2 3 4 5 0 0 6 7 8 9 1 2 3 4 5 6 7 8 9 1 2 3 4 5 6 7 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
8 9 1 2 3 4 5 6 7 8 9 1 2 3 4 5 6 7 8 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
9 1 2 3 4 5 6 7 8 9 1 2 3 4 5 6 7 8 9 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
4 5 6 7 8 9 1 2 3 4 0 0 0 0 0 0 0 0 0 0 0 5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
6 7 8 9 1 2 3 4 5 6 0 0 0 0 0 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
8 9 1 2 3 4 5 6 7 8 0 0 0 0 0 0 0 0 0 0 0 9 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
1 2 3 4 5 6 7 8 9 1 0 0 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
3 4 5 6 7 8 9 1 2 3 0 0 0 0 0 0 0 0 0 0 0 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
5 6 7 8 9 1 2 3 4 5 0 0 0 0 0 0 0 0 0 0 0 6 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
7 8 9 1 2 3 4 5 6 7 0 0 0 0 0 0 0 0 0 0 0 8 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
9 1 2 3 4 5 6 7 8 9 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
2 3 4 5 6 7 8 9 1 2 0 0 0 0 0 0 0 0 0 0 0 3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
4 5 6 7 8 9 1 2 3 4 0 0 0 0 0 0 0 0 0 0 0 5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
6 7 8 9 1 2 3 4 5 6 0 0 0 0 0 0 0 0 0 0 0 7 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
8 9 1 2 3 4 5 6 7 8 0 0 0 0 0 0 0 0 0 0 0 9 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
1 2 3 4 5 6 7 8 9 1 0 0 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
3 4 5 6 7 8 9 1 2 3 0 0 0 0 0 0 0 0 0 0 0 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 6 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
7 8 9 1 2 3 4 5 6 7 8 9 1 2 3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
4 5 6 7 8 9 1 2 3 4 5 6 7 8 9 0 0 0 0 0 0 1 2 3 4 5 6 7 8 9 1 2 3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
4 5 6 7 8 9 1 2 3 4 5 6 7 8 9 0 0 0 0 0 0 1 2 3 4 5 6 7 8 9 1 2 3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
4 5 6 7 8 9 1 2 3 4 5 6 7 8 9 0 0 0 0 0 0 1 2 3 4 5 6 7 8 9 1 2 3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
4 5 6 7 8 9 1 2 3 4 5 6 7 8 9 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
1 2 3 4 5 6 7 8 9 1 2 3 4 5 6 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
7 8 9 1 2 3 4 5 6 7 8 9 1 2 3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
4 5 6 7 8 9 1 2 3 4 5 6 7 8 9 0 0 0 0 0 0 1 2 3 4 5 6 7 8 9 1 2 3 4 5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
6 7 8 9 1 2 3 4 5 6 7 8 9 1 2 0 0 0 0 0 0 3 4 5 6 7 8 9 1 2 3 4 5 6 7 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
8 9 1 2 3 4 5 6 7 8 9 1 2 3 4 0 0 0 0 0 0 5 6 7 8 9 1 2 3 4 5 6 7 8 9 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
1 2 3 4 5 6 7 8 9 1 2 3 4 5 6 0 0 0 0 0 0 7 8 9 1 2 3 4 5 6 7 8 9 1 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 

'''